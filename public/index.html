<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenAi-ChatBot By Akash</title>
    <!-- MAIN STYLE -->
    <link rel="stylesheet" href="./style.css">
    <!-- MAIN SCRIPT -->
    <script src="./script.js"></script>
    <!-- Tailwind CSS -->
    <script src="./assets/tailwind.js"></script>
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            '50': '#f8fafc',
                            '100': '#f1f5f9',
                            '200': '#e2e8f0',
                            '300': '#cbd5e1',
                            '400': '#94a3b8',
                            '500': '#64748b',
                            '600': '#475569',
                            '700': '#334155',
                            '800': '#1e293b',
                            '900': '#0f172a',
                            '950': '#020617',
                        },
                        primary: "#475569",
                        secondary: "#64748b",
                        accent: "#1e293b",
                        disabled: "#cbd5e1",
                        back: "#f1f5f9",
                        fore: "#020617"
                    }
                }
            }
        }
    </script>
</head>

<body>

    <!-- holds place to inject html models/emements -->
    <div id="modelArea" class="bg-slate-900/50 block" tabindex="0"> </div>

    <!-- holds place to inject html custom alert-bar -->
    <div class="alert-bar" id="alertbar">
        <span id="alerttxt"></span>
    </div>

    <!-- Main content screen -->
    <div class="bg-back min-h-screen">
        <div class="container px-4">
            <main class="mainSection min-h-screen max-h-screen flex flex-col justify-between items-center"
                id="mainSection">
                <!-- Header -->
                <div class="mt-4 h-8 w-full flex justify-center items-center">
                    <div
                        class="wrapper w-full max-w-3xl p-3 px-4 bg-slate-300/40 backdrop-blur-sm rounded-3xl flex justify-between items-center">
                        <div class="h-6 w-6 text-slate-500 flex justify-center items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" class="lucide lucide-leaf">
                                <path
                                    d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z" />
                                <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12" />
                            </svg>
                        </div>

                        <div class="text-slate-800">
                            Welcome
                        </div>

                        <div class="relative">
                            <input type="checkbox" id="option" class="hidden absolute">
                            <label for="option" title="Menu"
                                class="text-slate-500 flex justify-center items-center rounded-3xl cursor-pointer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-more-vertical">
                                    <circle cx="12" cy="12" r="1" />
                                    <circle cx="12" cy="5" r="1" />
                                    <circle cx="12" cy="19" r="1" />
                                </svg>
                            </label>

                            <div id="optionmenu"
                                class="absolute opacity-0 right-0 z-10 mt-2 w-48 origin-top-right rounded-xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none overflow-clip"
                                role="menu" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1">
                                <ul class="block text-slate-600 divide-y text-sm">
                                    <li onclick='window.open("https://github.com/aksh-git/")'
                                        class="hover:bg-slate-300 block px-4 py-2 cursor-pointer flex items-center space-x-2">
                                        <div class="h-5 w-5 flex justify-center items-center text-sm ">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-github">
                                                <path
                                                    d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4" />
                                                <path d="M9 18c-4.51 2-5-2-7-2" />
                                            </svg>
                                        </div>
                                        <span>Github Repo</span>
                                    </li>
                                    <li onclick='window.open("https://akash-web.netlify.app/")'
                                        class="hover:bg-slate-300 block px-4 py-2 cursor-pointer flex items-center space-x-2">
                                        <div class="h-5 w-5 flex justify-center items-center text-sm ">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-globe-2">
                                                <path d="M21.54 15H17a2 2 0 0 0-2 2v4.54" />
                                                <path
                                                    d="M7 3.34V5a3 3 0 0 0 3 3v0a2 2 0 0 1 2 2v0c0 1.1.9 2 2 2v0a2 2 0 0 0 2-2v0c0-1.1.9-2 2-2h3.17" />
                                                <path
                                                    d="M11 21.95V18a2 2 0 0 0-2-2v0a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05" />
                                                <circle cx="12" cy="12" r="10" />
                                            </svg>
                                        </div>
                                        <span>Portfolio</span>
                                    </li>
                                    <li onclick='window.open("https://linkedin.com/in/ydevakash")'
                                        class="hover:bg-slate-300 block px-4 py-2 cursor-pointer flex items-center space-x-2">
                                        <div class="h-5 w-5 flex justify-center items-center text-sm ">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-linkedin">
                                                <path
                                                    d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
                                                <rect width="4" height="12" x="2" y="9" />
                                                <circle cx="4" cy="4" r="2" />
                                            </svg>
                                        </div>
                                        <span>Linkedin</span>
                                    </li>
                                    <li onclick='logout()'
                                        class="border-t-slate-700 hover:bg-red-400 hover:text-white block px-4 py-2 cursor-pointer flex items-center space-x-2">
                                        <div class="h-5 w-5 flex justify-center items-center text-sm ">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-log-out">
                                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                                <polyline points="16 17 21 12 16 7" />
                                                <line x1="21" x2="9" y1="12" y2="12" />
                                            </svg>
                                        </div>
                                        <span>Logout</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages area -->
                <div class="h-full flex flex-col gap-4 w-full max-w-3xl p-4 overflow-scroll scroll-smooth"
                    id="messages">
                </div>
                <!-- Input Area -->
                <div class="w-full flex flex-col justify-center items-center h-24">
                    <div class="flex w-full max-w-3xl p-1 h-20">
                        <form method="post" class="messageForm w-full flex gap-2 p-2" id="messageForm">
                            <input
                                class="p-2 px-4 text-base w-full border-2 border-slate-300 rounded-xl focus:outline-none focus:border-slate-400 text-slate-600"
                                type="text" name="userMessage" id="messageInput" autocomplete="off" required
                                oninput="inputChanged(this)" placeholder="Talk about anything..." maxlength="200">
                            <button
                                class="border-2 border-slate-300 bg-slate-300 font-medium py-1 px-3 rounded-xl text-base capitalize disabled:bg-slate-50 flex justify-center items-center text-slate-600"
                                type="submit" id="sumbitBtn" disabled title="Send">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-send">
                                    <path d="m22 2-7 20-4-9-9-4Z" />
                                    <path d="M22 2 11 13" />
                                </svg>
                            </button>
                        </form>
                    </div>
                    <div class="flex w-full max-w-3xl h-full">
                        <div class="p-1 w-full justify-center items-center">
                            <div class="text-slate-400 text-xs font-semibold text-center font-sans">
                                Created by <a class="underline" href="https://akash-web.netlify.app">Akash</a> - Powered
                                by <a class="underline" href="https://openai.com">OpenAI</a>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="./socket.js"></script>

    <script>
        var sumbitBtn = document.getElementById("sumbitBtn");
        function inputChanged(e) {
            if (e.value.length > 4) {
                sumbitBtn.disabled = false
            } else {
                sumbitBtn.disabled = true
            }
        }

        // Onload function
        window.onload = () => {
            var token = checkToken()
            if (token != null) {
                // auto focus
                document.getElementById("messageInput").focus()
                loadOlderChat();
            } else {
                // Create session model 
                createSessionModel()
            }
        }

        // Generate secret
        async function injectSecret() {
            // TODO : inject loader
            const secret = await getSecret();
            document.getElementById("secretGenratorInput").value = secret;
        }

        // Onclick event listiners
        function iKnowSecret() {
            injectSessionModelToSecretFrame(true);
        }
        function iDonthaveOne() {
            injectSessionModelToSecretFrame(false);
        }
    </script>
</body>

</html>